<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IIIT-H OSDG VPN Setup - Windows</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 100%);
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 2px solid #22d3ee;
            margin-bottom: 40px;
        }

        h1 {
            color: #22d3ee;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #a0a0a0;
            font-size: 1.1rem;
        }

        .button-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .copy-btn {
            background: #10b981;
            color: white;
        }

        .copy-btn:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .download-btn {
            background: #3b82f6;
            color: white;
        }

        .download-btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .copied {
            background: #22d3ee !important;
        }

        .code-container {
            background: #1e1e1e;
            border-radius: 12px;
            padding: 20px;
            margin: 30px 0;
            border: 1px solid #333;
            position: relative;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        .code-title {
            color: #22d3ee;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
        }

        .line-count {
            color: #666;
            font-size: 0.85rem;
        }

        pre {
            margin: 0;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            max-height: 500px;
            overflow-y: auto;
        }

        code {
            color: #e0e0e0;
        }

        .comment { color: #6a9955; }
        .string { color: #ce9178; }
        .keyword { color: #569cd6; }
        .function { color: #dcdcaa; }
        .variable { color: #9cdcfe; }

        .instructions {
            background: #2a2a3e;
            border-left: 4px solid #22d3ee;
            padding: 25px;
            border-radius: 8px;
            margin: 30px 0;
        }

        .instructions h2 {
            color: #22d3ee;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin: 10px 0;
            padding-left: 10px;
        }

        .warning {
            background: #3a2a1a;
            border-left: 4px solid #f59e0b;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .warning-title {
            color: #f59e0b;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .requirements {
            background: #1a2a3a;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .requirements h3 {
            color: #22d3ee;
            margin-bottom: 15px;
        }

        .requirements ul {
            list-style: none;
            margin-left: 0;
        }

        .requirements li:before {
            content: "‚úì ";
            color: #10b981;
            font-weight: bold;
            margin-right: 8px;
        }

        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid #333;
            color: #666;
        }

        footer a {
            color: #22d3ee;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê IIIT-H VPN Setup for Windows</h1>
            <p class="subtitle">Automated PowerShell script for Windows 10/11 (x64, x86, ARM64)</p>
        </header>

        <div class="button-group">
            <button class="copy-btn" onclick="copyScript()">
                <span id="copy-icon">üìã</span>
                <span id="copy-text">Copy Script</span>
            </button>
            <button class="download-btn" onclick="downloadScript()">
                üíæ Download Script (.ps1)
            </button>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span class="code-title">setup-vpn-windows.ps1</span>
                <span class="line-count">Lines: 1-151</span>
            </div>
            <pre><code id="script-content"># IIIT Hyderabad VPN Setup Script for Windows
# Compatible with: Windows 10/11 (x64, x86, ARM64)
# Author: OSDG Club, IIIT Hyderabad
# Last Updated: October 2025

Write-Host "=========================================" -ForegroundColor Cyan
Write-Host "  IIIT Hyderabad VPN Setup - Windows" -ForegroundColor Cyan
Write-Host "=========================================" -ForegroundColor Cyan
Write-Host ""

# Configuration
$ovpnConfigPath = Join-Path $env:USERPROFILE "Downloads\windows.ovpn"
$openvpnConnectExe = Join-Path $env:ProgramFiles "OpenVPN Connect\OpenVPNConnect.exe"
$installerUrl = "https://openvpn.net/downloads/openvpn-connect-v3-windows.msi"
$installerPath = Join-Path $env:TEMP "openvpn-connect-install.msi"

# Function to test internet connectivity
function Test-InternetConnection {
    try {
        $null = Test-Connection -ComputerName "openvpn.net" -Count 1 -ErrorAction Stop
        return $true
    } catch {
        return $false
    }
}

# Check internet connection
Write-Host "[1/5] Checking internet connection..." -ForegroundColor Yellow
if (-not (Test-InternetConnection)) {
    Write-Host "ERROR: No internet connection detected." -ForegroundColor Red
    Write-Host "Please connect to the internet and try again." -ForegroundColor Red
    exit 1
}
Write-Host "‚úì Internet connection verified" -ForegroundColor Green
Write-Host ""

# Check if config file exists
Write-Host "[2/5] Checking for VPN configuration file..." -ForegroundColor Yellow
if (-not (Test-Path $ovpnConfigPath)) {
    Write-Host "ERROR: Configuration file not found!" -ForegroundColor Red
    Write-Host "Expected location: $ovpnConfigPath" -ForegroundColor Red
    Write-Host ""
    Write-Host "Please:" -ForegroundColor Yellow
    Write-Host "  1. Download 'windows.ovpn' from the OSDG website" -ForegroundColor Yellow
    Write-Host "  2. Save it to your Downloads folder" -ForegroundColor Yellow
    Write-Host "  3. Run this script again" -ForegroundColor Yellow
    exit 2
}
Write-Host "‚úì Configuration file found" -ForegroundColor Green
Write-Host ""

# Check if OpenVPN Connect is installed
Write-Host "[3/5] Checking OpenVPN Connect installation..." -ForegroundColor Yellow
if (Test-Path $openvpnConnectExe) {
    Write-Host "‚úì OpenVPN Connect is already installed" -ForegroundColor Green
} else {
    Write-Host "OpenVPN Connect not found. Installing..." -ForegroundColor Yellow
    Write-Host ""
    
    try {
        # Download installer
        Write-Host "  Downloading OpenVPN Connect..." -ForegroundColor Cyan
        (New-Object System.Net.WebClient).DownloadFile($installerUrl, $installerPath)
        Write-Host "  ‚úì Download complete" -ForegroundColor Green
        
        # Install silently
        Write-Host "  Installing OpenVPN Connect (this may take 1-2 minutes)..." -ForegroundColor Cyan
        $installProcess = Start-Process -FilePath "msiexec.exe" -ArgumentList "/i `"$installerPath`" /qn /norestart" -Wait -PassThru
        
        if ($installProcess.ExitCode -ne 0) {
            throw "Installation failed with exit code: $($installProcess.ExitCode)"
        }
        
        # Clean up installer
        Remove-Item $installerPath -ErrorAction SilentlyContinue
        
        # Verify installation
        if (-not (Test-Path $openvpnConnectExe)) {
            throw "OpenVPN Connect executable not found after installation"
        }
        
        Write-Host "  ‚úì OpenVPN Connect installed successfully" -ForegroundColor Green
    } catch {
        Write-Host "ERROR: Installation failed - $_" -ForegroundColor Red
        if (Test-Path $installerPath) {
            Remove-Item $installerPath -ErrorAction SilentlyContinue
        }
        exit 1
    }
}
Write-Host ""

# Accept GDPR consent
Write-Host "[4/5] Configuring OpenVPN Connect..." -ForegroundColor Yellow
try {
    $null = & $openvpnConnectExe --accept-gdpr 2>&1
    Write-Host "‚úì GDPR consent accepted" -ForegroundColor Green
} catch {
    Write-Host "‚ö† GDPR consent may have already been accepted" -ForegroundColor Yellow
}
Write-Host ""

# Import VPN profile
Write-Host "[5/5] Importing VPN configuration..." -ForegroundColor Yellow
try {
    $importArgs = "--import-profile=`"$ovpnConfigPath`""
    & $openvpnConnectExe $importArgs
    
    Start-Sleep -Seconds 2
    Write-Host "‚úì VPN profile imported successfully" -ForegroundColor Green
} catch {
    Write-Host "ERROR: Failed to import VPN profile - $_" -ForegroundColor Red
    exit 1
}
Write-Host ""

# Success message
Write-Host "=========================================" -ForegroundColor Green
Write-Host "  ‚úì VPN SETUP COMPLETE!" -ForegroundColor Green
Write-Host "=========================================" -ForegroundColor Green
Write-Host ""
Write-Host "NEXT STEPS:" -ForegroundColor Cyan
Write-Host "  1. OpenVPN Connect will open automatically (or check system tray)" -ForegroundColor White
Write-Host "  2. Click the connection to activate it" -ForegroundColor White
Write-Host "  3. Enter your IIIT Hyderabad credentials when prompted:" -ForegroundColor White
Write-Host "     Username: your-iiith-email@students.iiit.ac.in" -ForegroundColor Yellow
Write-Host "     Password: your IIIT-H password" -ForegroundColor Yellow
Write-Host ""
Write-Host "USEFUL COMMANDS:" -ForegroundColor Cyan
Write-Host "  Open OpenVPN:  Start-Process '$openvpnConnectExe'" -ForegroundColor White
Write-Host ""
Write-Host "Need help? Visit the OSDG website or use our AI chatbot!" -ForegroundColor Cyan
Write-Host ""

# Optional: Open OpenVPN Connect GUI
try {
    Start-Process $openvpnConnectExe
} catch {
    Write-Host "Note: Please open OpenVPN Connect manually from Start Menu" -ForegroundColor Yellow
}</code></pre>
        </div>

        <div class="instructions">
            <h2>üìñ Installation Instructions</h2>
            <ol>
                <li><strong>Download your config file:</strong> Download <code>windows.ovpn</code> from the OSDG VPN page and save it to your Downloads folder</li>
                <li><strong>Copy the script:</strong> Click the "Copy Script" button above</li>
                <li><strong>Open PowerShell as Administrator:</strong>
                    <ul>
                        <li>Press <kbd>Win + X</kbd></li>
                        <li>Select "Windows PowerShell (Admin)" or "Terminal (Admin)"</li>
                    </ul>
                </li>
                <li><strong>Paste and run:</strong> Right-click in PowerShell window to paste, then press <kbd>Enter</kbd></li>
                <li><strong>Wait for completion:</strong> The script will automatically install OpenVPN and configure your VPN</li>
                <li><strong>Enter credentials:</strong> When prompted, enter your IIIT-H email and password</li>
            </ol>
        </div>

        <div class="warning">
            <div class="warning-title">‚ö†Ô∏è Important Notes</div>
            <ul>
                <li>You must run PowerShell as Administrator</li>
                <li>Ensure <code>windows.ovpn</code> is in your Downloads folder before running</li>
                <li>Internet connection is required for installation</li>
                <li>Antivirus may need to allow OpenVPN installation</li>
            </ul>
        </div>

        <div class="requirements">
            <h3>‚úÖ Requirements</h3>
            <ul>
                <li>Windows 10 or Windows 11 (any architecture: x64, x86, ARM64)</li>
                <li>Administrator privileges</li>
                <li>Active internet connection</li>
                <li>Downloaded <code>windows.ovpn</code> config file</li>
                <li>IIIT Hyderabad student credentials</li>
            </ul>
        </div>

        <footer>
            <p>Having trouble? <a href="/vpn-setup">Use our AI-powered troubleshooting chatbot</a></p>
            <p>¬© 2025 OSDG Club, IIIT Hyderabad</p>
        </footer>
    </div>

    <script>
        function copyScript() {
            const scriptContent = document.getElementById('script-content').textContent;
            const copyBtn = document.querySelector('.copy-btn');
            const copyIcon = document.getElementById('copy-icon');
            const copyText = document.getElementById('copy-text');
            
            navigator.clipboard.writeText(scriptContent).then(() => {
                // Visual feedback
                copyBtn.classList.add('copied');
                copyIcon.textContent = '‚úì';
                copyText.textContent = 'Copied!';
                
                // Reset after 2 seconds
                setTimeout(() => {
                    copyBtn.classList.remove('copied');
                    copyIcon.textContent = 'üìã';
                    copyText.textContent = 'Copy Script';
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
                alert('Failed to copy script. Please try again or copy manually.');
            });
        }

        function downloadScript() {
            const scriptContent = document.getElementById('script-content').textContent;
            const blob = new Blob([scriptContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'setup-vpn-windows.ps1';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }
    </script>
</body>
</html>
